<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdrenalineFlow - Tu Compañero Anti-Procrastinación</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .main-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .timer-card {
            text-align: center;
        }

        .timer-display {
            font-size: 4em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            color: white;
        }

        .task-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-group label {
            font-weight: 600;
            color: #555;
        }

        .form-control {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
        }

        .task-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            position: relative;
        }

        .task-item.urgent {
            border-left-color: #ff6b6b;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-weight: 600;
            font-size: 1.1em;
            flex-grow: 1;
        }

        .task-deadline {
            font-size: 0.9em;
            color: #666;
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 15px;
        }

        .task-deadline.urgent {
            background: #ff6b6b;
            color: white;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .task-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.9em;
        }

        .progress-section {
            margin-top: 15px;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .gamification-section {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4a 100%);
            color: #333;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .achievement-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
        }

        .habits-tracker {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 10px;
        }

        .habit-day {
            aspect-ratio: 1;
            border-radius: 5px;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8em;
        }

        .habit-day.completed {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .habit-day:hover {
            transform: scale(1.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-modal {
            float: right;
            font-size: 2em;
            cursor: pointer;
            color: #666;
        }

        .notifications {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }

        .notification {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .timer-display {
                font-size: 2.5em;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }

        .urgency-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .urgency-low {
            background: #51cf66;
        }

        .urgency-medium {
            background: #ffd43b;
        }

        .urgency-high {
            background: #ff6b6b;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <h1>⚡ AdrenalineFlow</h1>
            <p>Tu compañero personal para dominar la procrastinación buscando adrenalina</p>
        </div>

        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="tasksCompleted">0</div>
                <div class="stat-label">Tareas Completadas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="streakDays">0</div>
                <div class="stat-label">Racha (días)</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="adrenalinesUsed">0</div>
                <div class="stat-label">Dosis de Adrenalina</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="level">1</div>
                <div class="stat-label">Nivel</div>
            </div>
        </div>

        <!-- Gamification Section -->
        <div class="gamification-section">
            <h3>🏆 Logros Desbloqueados</h3>
            <div id="achievements">
                <span class="achievement-badge">🚀 Primer Sprint</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Timer Pomodoro Intensivo -->
            <div class="card timer-card">
                <h2>⏱️ Timer de Adrenalina</h2>
                <div class="timer-display" id="timerDisplay">25:00</div>
                <div class="timer-controls">
                    <button class="btn btn-primary" onclick="startTimer()">Iniciar</button>
                    <button class="btn btn-secondary" onclick="pauseTimer()">Pausar</button>
                    <button class="btn btn-danger" onclick="resetTimer()">Reset</button>
                </div>
                <div style="margin-top: 20px;">
                    <label for="timerType">Modo:</label>
                    <select id="timerType" class="form-control" onchange="changeTimerMode()">
                        <option value="25">Sprint Intenso (25 min)</option>
                        <option value="15">Ráfaga Rápida (15 min)</option>
                        <option value="45">Desafío Extremo (45 min)</option>
                        <option value="5">Micro-Sprint (5 min)</option>
                    </select>
                </div>
            </div>

            <!-- Gestión de Tareas con Mini-Deadlines -->
            <div class="card">
                <h2>📋 Tareas con Mini-Deadlines</h2>
                <form class="task-form" onsubmit="addTask(event)">
                    <div class="form-group">
                        <label for="taskTitle">Tarea:</label>
                        <input type="text" id="taskTitle" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="taskDeadline">Deadline Artificial:</label>
                        <input type="datetime-local" id="taskDeadline" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">Nivel de Urgencia:</label>
                        <select id="taskPriority" class="form-control">
                            <option value="low">Baja Presión</option>
                            <option value="medium">Presión Media</option>
                            <option value="high">Alta Adrenalina</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Agregar Tarea</button>
                </form>
                
                <div id="taskList" style="margin-top: 20px;"></div>
            </div>

            <!-- Estimulación Alternativa -->
            <div class="card">
                <h2>⚡ Generador de Adrenalina</h2>
                <p>Cuando necesites estimulación sin esperar al último minuto:</p>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px;">
                    <button class="btn btn-success" onclick="adrenalineBoost('music')">🎵 Música Energizante</button>
                    <button class="btn btn-success" onclick="adrenalineBoost('challenge')">🎯 Mini Desafío</button>
                    <button class="btn btn-success" onclick="adrenalineBoost('competition')">🏁 Competencia Virtual</button>
                    <button class="btn btn-success" onclick="adrenalineBoost('reward')">🎁 Sistema de Recompensas</button>
                </div>
                
                <div id="adrenalineContent" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; display: none;">
                    <div id="adrenalineText"></div>
                </div>
            </div>

            <!-- Tracker de Hábitos -->
            <div class="card">
                <h2>📈 Tracker de Hábitos Semanales</h2>
                <div>
                    <h4>Trabajar en bloques intensos</h4>
                    <div class="habits-tracker" id="habitsTracker">
                        <!-- Se generará dinámicamente -->
                    </div>
                </div>
                
                <div class="progress-section">
                    <div class="progress-bar">
                        <div class="progress-fill" id="habitProgress" style="width: 0%"></div>
                    </div>
                    <small>Progreso semanal: <span id="habitPercentage">0%</span></small>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications Container -->
    <div class="notifications" id="notifications"></div>

    <!-- Modal for detailed task view -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Estado de la aplicación
        let appState = {
            tasks: JSON.parse(localStorage.getItem('adrenalineTasks') || '[]'),
            stats: JSON.parse(localStorage.getItem('adrenalineStats') || '{"tasksCompleted": 0, "streakDays": 0, "adrenalinesUsed": 0, "level": 1}'),
            habits: JSON.parse(localStorage.getItem('adrenalineHabits') || '[]'),
            timer: {
                minutes: 25,
                seconds: 0,
                isRunning: false,
                interval: null
            }
        };

        // Timer functions
        function startTimer() {
            if (!appState.timer.isRunning) {
                appState.timer.isRunning = true;
                appState.timer.interval = setInterval(updateTimer, 1000);
                showNotification('⚡ ¡Timer iniciado! A darlo todo!');
            }
        }

        function pauseTimer() {
            appState.timer.isRunning = false;
            if (appState.timer.interval) {
                clearInterval(appState.timer.interval);
            }
            showNotification('⏸️ Timer pausado');
        }

        function resetTimer() {
            pauseTimer();
            const selectedTime = parseInt(document.getElementById('timerType').value);
            appState.timer.minutes = selectedTime;
            appState.timer.seconds = 0;
            updateTimerDisplay();
            showNotification('🔄 Timer reiniciado');
        }

        function updateTimer() {
            if (appState.timer.seconds === 0) {
                if (appState.timer.minutes === 0) {
                    // Timer completado
                    pauseTimer();
                    appState.stats.adrenalinesUsed++;
                    updateStats();
                    showNotification('🎉 ¡Sprint completado! ¡Eres increíble!');
                    checkAchievements();
                    return;
                }
                appState.timer.minutes--;
                appState.timer.seconds = 59;
            } else {
                appState.timer.seconds--;
            }
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = appState.timer.minutes.toString().padStart(2, '0');
            const seconds = appState.timer.seconds.toString().padStart(2, '0');
            document.getElementById('timerDisplay').textContent = `${minutes}:${seconds}`;
        }

        function changeTimerMode() {
            resetTimer();
        }

        // Task management
        function addTask(event) {
            event.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const deadline = document.getElementById('taskDeadline').value;
            const priority = document.getElementById('taskPriority').value;
            
            const task = {
                id: Date.now(),
                title,
                deadline: new Date(deadline),
                priority,
                completed: false,
                createdAt: new Date()
            };
            
            appState.tasks.push(task);
            saveData();
            renderTasks();
            
            // Reset form
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDeadline').value = '';
            
            showNotification('🆕 ¡Tarea agregada con deadline artificial!');
        }

        function renderTasks() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            // Ordenar por deadline
            const sortedTasks = [...appState.tasks].sort((a, b) => new Date(a.deadline) - new Date(b.deadline));
            
            sortedTasks.forEach(task => {
                const taskElement = createTaskElement(task);
                taskList.appendChild(taskElement);
            });
        }

        function createTaskElement(task) {
            const taskDiv = document.createElement('div');
            const now = new Date();
            const timeLeft = new Date(task.deadline) - now;
            const isUrgent = timeLeft < 24 * 60 * 60 * 1000 && timeLeft > 0; // Menos de 24 horas
            const isOverdue = timeLeft < 0;
            
            taskDiv.className = `task-item ${task.completed ? 'completed' : ''} ${isUrgent || isOverdue ? 'urgent' : ''}`;
            
            const urgencyClass = task.priority === 'high' ? 'urgency-high' : 
                                task.priority === 'medium' ? 'urgency-medium' : 'urgency-low';
            
            taskDiv.innerHTML = `
                <div class="task-header">
                    <div class="task-title">${task.title}</div>
                    <div class="urgency-indicator ${urgencyClass}"></div>
                </div>
                <div class="task-deadline ${isUrgent || isOverdue ? 'urgent' : ''}">
                    ${formatTimeLeft(timeLeft)} | ${new Date(task.deadline).toLocaleString()}
                </div>
                <div class="task-actions">
                    <button class="btn btn-success btn-small" onclick="completeTask(${task.id})">
                        ${task.completed ? 'Desmarcar' : 'Completar'}
                    </button>
                    <button class="btn btn-primary btn-small" onclick="startTaskTimer(${task.id})">Timer</button>
                    <button class="btn btn-danger btn-small" onclick="deleteTask(${task.id})">Eliminar</button>
                </div>
            `;
            
            return taskDiv;
        }

        function formatTimeLeft(timeLeft) {
            if (timeLeft < 0) return '⏰ VENCIDO';
            
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) return `${days}d ${hours}h`;
            if (hours > 0) return `${hours}h ${minutes}m`;
            return `${minutes}m`;
        }

        function completeTask(id) {
            const task = appState.tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                if (task.completed && !task.wasCompleted) {
                    appState.stats.tasksCompleted++;
                    task.wasCompleted = true;
                    updateStats();
                    showNotification('🎉 ¡Tarea completada! ¡Adrenalina bien canalizada!');
                    checkAchievements();
                }
                saveData();
                renderTasks();
            }
        }

        function deleteTask(id) {
            appState.tasks = appState.tasks.filter(t => t.id !== id);
            saveData();
            renderTasks();
            showNotification('🗑️ Tarea eliminada');
        }

        function startTaskTimer(id) {
            const task = appState.tasks.find(t => t.id === id);
            if (task) {
                showNotification(`⏱️ Timer iniciado para: ${task.title}`);
                startTimer();
            }
        }

        // Adrenaline boost functions
        function adrenalineBoost(type) {
            const content = document.getElementById('adrenalineContent');
            const text = document.getElementById('adrenalineText');
            
            const boosts = {
                music: {
                    title: '🎵 Playlist de Alta Energía',
                    content: 'Reproduce música con BPM alto (120-140). Géneros recomendados: EDM, Rock, Drum & Bass. Usa auriculares para máxima inmersión.'
                },
                challenge: {
                    title: '🎯 Mini Desafío Instantáneo',
                    content: 'Completa esta tarea en exactamente 10 minutos. Si lo logras, ganas 10 puntos extra. ¡El cronómetro ya comenzó!'
                },
                competition: {
                    title: '🏁 Competencia Virtual',
                    content: 'Imagina que estás compitiendo contra tu "yo" del día anterior. ¿Puedes superar tu tiempo? ¡La carrera ya comenzó!'
                },
                reward: {
                    title: '🎁 Sistema de Recompensas',
                    content: 'Al completar esta tarea, te has ganado: 15 min de tu actividad favorita. ¡Pero solo si la terminas en el tiempo límite!'
                }
            };
            
            const boost = boosts[type];
            text.innerHTML = `<h4>${boost.title}</h4><p>${boost.content}</p>`;
            content.style.display = 'block';
            
            appState.stats.adrenalinesUsed++;
            updateStats();
            showNotification('⚡ ¡Dosis de adrenalina activada!');
        }

        // Habits tracking
        function initHabitsTracker() {
            const tracker = document.getElementById('habitsTracker');
            tracker.innerHTML = '';
            
            const days = ['L', 'M', 'X', 'J', 'V', 'S', 'D'];
            const today = new Date();
            const currentWeek = getCurrentWeek();
            
            days.forEach((day, index) => {
                const dayElement = document.createElement('div');
                dayElement.className = 'habit-day';
                dayElement.textContent = day;
                dayElement.onclick = () => toggleHabit(index);
                
                if (appState.habits.includes(index)) {
                    dayElement.classList.add('completed');
                }
                
                tracker.appendChild(dayElement);
            });
            
            updateHabitProgress();
        }

        function toggleHabit(dayIndex) {
            const index = appState.habits.indexOf(dayIndex);
            if (index > -1) {
                appState.habits.splice(index, 1);
            } else {
                appState.habits.push(dayIndex);
            }
            saveData();
            initHabitsTracker();
            showNotification('📈 Hábito actualizado');
        }

        function updateHabitProgress() {
            const percentage = (appState.habits.length / 7) * 100;
            document.getElementById('habitProgress').style.width = percentage + '%';
            document.getElementById('habitPercentage').textContent = Math.round(percentage) + '%';
        }

        function getCurrentWeek() {
            const today = new Date();
            const monday = new Date(today);
            monday.setDate(today.getDate() - (today.getDay() + 6) % 7);
            return monday;
        }

        // Stats and achievements
        function updateStats() {
            document.getElementById('tasksCompleted').textContent = appState.stats.tasksCompleted;
            document.getElementById('streakDays').textContent = appState.stats.streakDays;
            document.getElementById('adrenalinesUsed').textContent = appState.stats.adrenalinesUsed;
            document.getElementById('level').textContent = appState.stats.level;
            
            // Level up logic
            const newLevel = Math.floor(appState.stats.tasksCompleted / 10) + 1;
            if (newLevel > appState.stats.level) {
                appState.stats.level = newLevel;
                showNotification(`🌟 ¡Nivel ${newLevel} alcanzado! ¡Eres imparable!`);
            }
        }

        function checkAchievements() {
            const achievements = document.getElementById('achievements');
            
            if (appState.stats.tasksCompleted >= 5 && !achievements.innerHTML.includes('Sprint Master')) {
                achievements.innerHTML += '<span class="achievement-badge">⚡ Sprint Master</span>';
            }
            
            if (appState.stats.adrenalinesUsed >= 10 && !achievements.innerHTML.includes('Adicto a la Adrenalina')) {
                achievements.innerHTML += '<span class="achievement-badge">🔥 Adicto a la Adrenalina</span>';
            }
            
            if (appState.habits.length >= 7 && !achievements.innerHTML.includes('Semana Perfecta')) {
                achievements.innerHTML += '<span class="achievement-badge"> Semana Perfecta</span>';
            }
        }

        // Utility functions
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            document.getElementById('notifications').appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function saveData() {
            localStorage.setItem('adrenalineTasks', JSON.stringify(appState.tasks));
            localStorage.setItem('adrenalineStats', JSON.stringify(appState.stats));
            localStorage.setItem('adrenalineHabits', JSON.stringify(appState.habits));
        }

        function closeModal() {
            document.getElementById('taskModal').classList.remove('active');
        }

        // Funciones específicas para procrastinadores buscadores de adrenalina
        function createArtificialUrgency() {
            const urgentTasks = appState.tasks.filter(task => {
                const timeLeft = new Date(task.deadline) - new Date();
                return timeLeft < 2 * 60 * 60 * 1000 && timeLeft > 0; // Menos de 2 horas
            });
            
            if (urgentTasks.length > 0) {
                showNotification(`⚠ ¡${urgentTasks.length} tareas urgentes! ¡Es hora de la adrenalina!`);
            }
        }

        function generateMotivationalPush() {
            const messages = [
                "⚡ ¡La presión te hace brillar! ¡Aprovecha este momento!",
                "🔥 Tu mejor trabajo surge bajo presión. ¡Demuéstralo!",
                "🚀 El tiempo se agota, pero tú tienes el control. ¡Dale!",
                " La adrenalina está fluyendo. ¡Canalízala en productividad!",
                "💪 Los diamantes se forman bajo presión. ¡Tú eres un diamante!"
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            showNotification(randomMessage);
        }

        function checkForProcrastinationPattern() {
            const incompleteTasks = appState.tasks.filter(task => !task.completed);
            const overdueTasks = incompleteTasks.filter(task => new Date(task.deadline) < new Date());
            
            if (overdueTasks.length > 2) {
                showNotification("🎯 Patrón detectado: Varias tareas vencidas. ¡Tiempo de crear nueva adrenalina!");
                suggestAdrenalineStrategy();
            }
        }

        function suggestAdrenalineStrategy() {
            const strategies = [
                "Convierte la próxima tarea en un desafío de velocidad",
                "Crea un deadline artificial 2 horas antes del real",
                "Divide la tarea grande en micro-sprints de 15 minutos",
                "Imagina que estás en una competencia contra tiempo",
                "Establece una recompensa inmediata al completar"
            ];
            
            const strategy = strategies[Math.floor(Math.random() * strategies.length)];
            
            const modal = document.getElementById('taskModal');
            const modalContent = document.getElementById('modalContent');
            
            modalContent.innerHTML = `
                <h3>🎯 Estrategia Anti-Procrastinación</h3>
                <p><strong>Sugerencia personalizada:</strong></p>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0;">
                    ${strategy}
                </div>
                <p>¿Listo para convertir la presión en productividad?</p>
                <button class="btn btn-primary" onclick="closeModal(); generateMotivationalPush();">
                    ¡Sí, vamos a hacerlo! ⚡
                </button>
            `;
            
            modal.classList.add('active');
        }

        // Sistema de recompensas gamificado
        function calculateAdrenalineScore() {
            const urgentCompleted = appState.tasks.filter(task => {
                const timeLeft = new Date(task.deadline) - new Date(task.createdAt);
                const completionTime = new Date(task.deadline) - new Date();
                return task.completed && completionTime < timeLeft * 0.3; // Completado en el último 30% del tiempo
            }).length;
            
            return urgentCompleted * 50 + appState.stats.adrenalinesUsed * 10 + appState.habits.length * 20;
        }

        // Función para detectar el mejor momento del día para cada usuario
        function trackProductivityPatterns() {
            const currentHour = new Date().getHours();
            const completedToday = appState.tasks.filter(task => {
                const today = new Date().toDateString();
                return task.completed && new Date(task.completedAt).toDateString() === today;
            });
            
            if (completedToday.length > 0) {
                const patterns = JSON.parse(localStorage.getItem('productivityPatterns') || '{}');
                patterns[currentHour] = (patterns[currentHour] || 0) + completedToday.length;
                localStorage.setItem('productivityPatterns', JSON.stringify(patterns));
            }
        }

        // Función para sugerir el mejor momento para tareas importantes
        function suggestOptimalTime() {
            const patterns = JSON.parse(localStorage.getItem('productivityPatterns') || '{}');
            const bestHour = Object.keys(patterns).reduce((a, b) => patterns[a] > patterns[b] ? a : b, '9');
            
            if (Object.keys(patterns).length > 0) {
                return `Tu hora más productiva es: ${bestHour}:00. ¡Programa las tareas importantes para entonces!`;
            }
            return "Aún estamos analizando tus patrones de productividad.";
        }

        // Sistema de alertas inteligentes
        function setupSmartAlerts() {
            setInterval(() => {
                createArtificialUrgency();
                checkForProcrastinationPattern();
                
                // Motivación aleatoria cada 30 minutos si hay tareas pendientes
                const pendingTasks = appState.tasks.filter(task => !task.completed).length;
                if (pendingTasks > 0 && Math.random() < 0.3) {
                    generateMotivationalPush();
                }
            }, 30 * 60 * 1000); // Cada 30 minutos
        }

        // Función para exportar datos y análisis
        function generateProductivityReport() {
            const report = {
                totalTasks: appState.stats.tasksCompleted,
                adrenalineScore: calculateAdrenalineScore(),
                weeklyHabits: (appState.habits.length / 7 * 100).toFixed(1) + '%',
                optimalTime: suggestOptimalTime(),
                level: appState.stats.level,
                patterns: JSON.parse(localStorage.getItem('productivityPatterns') || '{}')
            };
            
            const modal = document.getElementById('taskModal');
            const modalContent = document.getElementById('modalContent');
            
            modalContent.innerHTML = `
                <h3>📊 Tu Reporte de Productividad</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #667eea; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold;">${report.totalTasks}</div>
                        <div>Tareas Completadas</div>
                    </div>
                    <div style="background: #51cf66; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold;">${report.adrenalineScore}</div>
                        <div>Puntos de Adrenalina</div>
                    </div>
                    <div style="background: #ffd43b; color: #333; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold;">${report.weeklyHabits}</div>
                        <div>Consistencia Semanal</div>
                    </div>
                    <div style="background: #ff6b6b; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold;">Nivel ${report.level}</div>
                        <div>Tu Nivel Actual</div>
                    </div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0;">
                    <h4>💡 Insight Personal:</h4>
                    <p>${report.optimalTime}</p>
                </div>
                <button class="btn btn-primary" onclick="closeModal()">Cerrar</button>
            `;
            
            modal.classList.add('active');
        }

        // Agregar botón para el reporte
        function addReportButton() {
            const header = document.querySelector('.header');
            const reportBtn = document.createElement('button');
            reportBtn.className = 'btn btn-secondary';
            reportBtn.style.marginTop = '15px';
            reportBtn.textContent = '📊 Ver Reporte de Productividad';
            reportBtn.onclick = generateProductivityReport;
            header.appendChild(reportBtn);
        }

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar datos
            updateStats();
            renderTasks();
            initHabitsTracker();
            updateTimerDisplay();
            addReportButton();
            
            // Configurar alertas inteligentes
            setupSmartAlerts();
            
            // Mensaje de bienvenida
            setTimeout(() => {
                showNotification('🚀 ¡Bienvenido a AdrenalineFlow! Tu compañero para canalizar la procrastinación en productividad.');
            }, 1000);
            
            // Configurar deadline por defecto (2 horas desde ahora)
            const deadlineInput = document.getElementById('taskDeadline');
            const now = new Date();
            now.setHours(now.getHours() + 2);
            deadlineInput.value = now.toISOString().slice(0, 16);
            
            // Actualizar tareas cada minuto
            setInterval(() => {
                renderTasks();
                trackProductivityPatterns();
            }, 60000);
            
            // Verificar si hay tareas vencidas al cargar
            setTimeout(checkForProcrastinationPattern, 2000);
        });

        // Atajos de teclado para usuarios que buscan velocidad
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 't':
                        e.preventDefault();
                        document.getElementById('taskTitle').focus();
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (!appState.timer.isRunning) {
                            startTimer();
                        }
                        break;
                    case ' ':
                        e.preventDefault();
                        if (appState.timer.isRunning) {
                            pauseTimer();
                        } else {
                            startTimer();
                        }
                        break;
                }
            }
        });

        // Función para limpiar tareas completadas
        function clearCompletedTasks() {
            appState.tasks = appState.tasks.filter(task => !task.completed);
            saveData();
            renderTasks();
            showNotification('🗑️ Tareas completadas eliminadas');
        }

        // Agregar botón de limpieza
        setTimeout(() => {
            const taskCard = document.querySelector('.card h2').parentElement;
            const clearBtn = document.createElement('button');
            clearBtn.className = 'btn btn-secondary btn-small';
            clearBtn.style.marginTop = '10px';
            clearBtn.textContent = 'Limpiar Completadas';
            clearBtn.onclick = clearCompletedTasks;
            taskCard.appendChild(clearBtn);
        }, 100);

        // Web App Manifest para instalación móvil
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript,console.log("AdrenalineFlow PWA ready")');
        }
    </script>
</body>
</html>
